
CyberAttack Techiques - Lab 1:  Vulnerable TLS Server
Authors:
    - Ignacio √Åvila Reyes (100563569)
    - Ksenia Myakisheva (100575673)

TEST TO 10.0.3.149:443

==========================
        DESCRIPTION
==========================
These test has been performed over the port 443
on metasploitable2 lab VM.

The only parameter that has been changed is the presence of 
HSTS, but with a lower max-age.

We include the next line on the ssl.conf file on /etc/apache/sites-enabled/ directory:
    Header always set Strict-Transport-Security "max-age=1000; includeSubDomains"
And reset the server with:
    sudo /etc/init.d/apache2 restart

No other parameter related to the certificate nor the SSL configuration has been changed
==========================
          INPUT
==========================
vulnTLSServer.nse

==========================
          OUTPUT
==========================
| vulnTLSServer: 
|   
|   **********************
|   CRITICAL ALERTS: 2
|   **********************
|   - Cipher includes CBC mode or SHA hash algorithm.
|   - TLS compression is enabled: DEFLATE compression (Protocol: TLSv1.0)
|   
|   
|   **********************
|   HIGH ALERTS: 15
|   **********************
|   - Server does not support TLS 1.2 or TLS 1.3
|   - Unapproved TLS cipher: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA (Protocol: TLSv1.0)
|   - ...
|   - ...
|   - Unapproved TLS cipher: TLS_RSA_WITH_RC4_128_SHA (Protocol: TLSv1.0)
|   
|   
|   **********************
|   MEDIUM ALERTS: 3
|   **********************
|   - Certificate lifespan is -45 days (less than recommended 90 days)
|   - [ENHANCED] HSTS max-age is less than 2 years: 1000 seconds
|   - [ENHANCED] Server information disclosure in server header: Apache/2.2.8 (Ubuntu) DAV/2 mod_ssl/2.2.8 OpenSSL/0.9.8g (version: 2.2)
|   
|   
|   **********************
|   LOW ALERTS: 3
|   **********************
|   - Certificate contains IP addresses in CN or SAN: 10.0.3.149
|   - [ENHANCED] CN and SAN Attributes: No Subject Alternative Name extension found.
|   - [ENHANCED] Server follows client cipher preference
|_   

==========================
          COMMAND
==========================
nmap -p 9443 --script vulnTLSServer -oN test.out
